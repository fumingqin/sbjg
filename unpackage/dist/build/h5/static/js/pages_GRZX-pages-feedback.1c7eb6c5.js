(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages_GRZX-pages-feedback"],{"1d25":function(e,t,a){"use strict";(function(e){a("a434"),a("d3b7"),a("3ca3"),a("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"robby-image-upload",props:["value","enableDel","enableAdd","enableDrag","serverUrl","formData","header","limit","fileKeyName","showUploadProgress","serverUrlDeleteImage"],data:function(){return{imageBasePos:{x0:-1,y0:-1,w:-1,h:-1},showMoveImage:!1,moveImagePath:"",moveLeft:0,moveTop:0,deltaLeft:0,deltaTop:0,dragIndex:null,targetImageIndex:null,imageList:[],isDestroyed:!1}},mounted:function(){this.imageList=this.value,!1===this.showUploadProgress?this.showUploadProgress=!1:this.showUploadProgress=!0},destroyed:function(){this.isDestroyed=!0},computed:{imageListData:function(){if(this.value)return this.value},posMoveImageLeft:function(){return this.moveLeft+"px"},posMoveImageTop:function(){return this.moveTop+"px"},isShowDel:function(){return!1!==this.enableDel},isShowAdd:function(){return!1!==this.enableAdd&&!(this.limit&&this.imageList.length>=this.limit)},isDragable:function(){return!1!==this.enableDrag}},methods:{selectImage:function(){var t=this;t.imageList||(t.imageList=[]),uni.chooseImage({count:t.limit?t.limit-t.imageList.length:999,success:function(a){var i=a.tempFilePaths;if(t.limit){var n=t.limit-t.imageList.length;if(n<i.length)return void uni.showToast({title:"图片总数限制为"+t.limit+"张，当前还可以选"+n+"张",icon:"none",mask:!1,duration:2e3})}if(t.serverUrl){uni.showToast({title:"上传进度：0/"+i.length,icon:"none",mask:!1});for(var s=t.imageList.length-i.length,o=[],r=t.fileKeyName?t.fileKeyName:"upload-images",l=0,d=function(a){o.push(new Promise((function(n,o){var d=s+a;uni.uploadFile({url:t.serverUrl,fileType:"image",header:t.header,formData:t.formData,filePath:i[a],name:r,success:function(a){if(200===a.statusCode){if(t.isDestroyed)return;l++,t.showUploadProgress&&uni.showToast({title:"上传进度："+l+"/"+i.length,icon:"none",mask:!1,duration:500}),e.log("success to upload image: "+a.data),n(a.data)}else e.log("fail to upload image:"+a.data),o("fail to upload image:"+d)},fail:function(t){e.log("fail to upload image:"+t),o("fail to upload image:"+d)}})})))},u=0;u<i.length;u++)d(u);Promise.all(o).then((function(e){if(!t.isDestroyed){for(var a=0;a<e.length;a++)t.imageList.push(e[a]);t.$emit("add",{currentImages:i,allImages:t.imageList}),t.$emit("input",t.imageList)}}))}else{for(var f=0;f<i.length;f++)t.imageList.push(i[f]);t.$emit("add",{currentImages:i,allImages:t.imageList}),t.$emit("input",t.imageList)}}})},deleteImage:function(t){var a=t.currentTarget.dataset.index,i=this.imageList[a];this.imageList.splice(a,1),this.serverUrlDeleteImage&&uni.request({url:this.serverUrlDeleteImage,method:"GET",data:{imagePath:i},success:function(t){e.log(t.data)}}),this.$emit("delete",{currentImage:i,allImages:this.imageList}),this.$emit("input",this.imageList)},previewImage:function(e){var t=e.currentTarget.dataset.index;uni.previewImage({current:this.imageList[t],indicator:"number",loop:"true",urls:this.imageList})},initImageBasePos:function(){var e=.024,t=this;uni.getSystemInfo({success:function(a){var i=a.screenWidth,n=Math.ceil(e*i),s=Math.ceil((i-2*n)/4);t.imageBasePos.x0=n,t.imageBasePos.w=s,t.imageBasePos.h=s}})},findOverlapImage:function(e,t){var a=Math.floor((e-this.imageBasePos.x0)/this.imageBasePos.w),i=Math.floor((t-this.imageBasePos.y0)/this.imageBasePos.h),n=4*i+a;return n},isDragging:function(e){return this.dragIndex===e},start:function(t){if(e.log(this.isDragable),this.isDragable){if(this.dragIndex=t.currentTarget.dataset.index,this.moveImagePath=this.imageList[this.dragIndex],this.showMoveImage=!0,-1===this.imageBasePos.y0){this.initImageBasePos();var a=Math.floor(this.dragIndex/4)*this.imageBasePos.h,i=t.currentTarget.offsetTop;this.imageBasePos.y0=i-a}this.moveLeft=t.target.offsetLeft,this.moveTop=t.target.offsetTop}},move:function(e){if(this.isDragable){var t=e.touches[0];this.targetImageIndex=this.findOverlapImage(t.clientX,t.clientY),0===this.deltaLeft&&(this.deltaLeft=t.clientX-this.moveLeft,this.deltaTop=t.clientY-this.moveTop),this.moveLeft=t.clientX-this.deltaLeft,this.moveTop=t.clientY-this.deltaTop}},stop:function(e){this.isDragable&&(null!==this.dragIndex&&null!==this.targetImageIndex&&(this.targetImageIndex<0&&(this.targetImageIndex=0),this.targetImageIndex>=this.imageList.length&&(this.targetImageIndex=this.imageList.length-1),this.dragIndex!==this.targetImageIndex&&(this.imageList[this.dragIndex]=this.imageList[this.targetImageIndex],this.imageList[this.targetImageIndex]=this.moveImagePath)),this.dragIndex=null,this.targetImageIndex=null,this.deltaLeft=0,this.deltaTop=0,this.showMoveImage=!1,this.$emit("input",this.imageList))}}};t.default=i}).call(this,a("5a52")["default"])},"404f":function(e,t,a){"use strict";var i=a("6873"),n=a.n(i);n.a},"4c0a":function(e,t,a){"use strict";a.r(t);var i=a("e47c"),n=a("d3a4");for(var s in n)"default"!==s&&function(e){a.d(t,e,(function(){return n[e]}))}(s);a("404f");var o,r=a("f0c5"),l=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,"3a1c2736",null,!1,i["a"],o);t["default"]=l.exports},"61e7":function(e,t,a){"use strict";var i;a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"imageUploadContainer"},[a("v-uni-view",{staticClass:"imageUploadList"},[e._l(e.imageListData,(function(t,i){return a("v-uni-view",{key:i,staticClass:"imageItem"},[a("v-uni-image",{class:{dragging:e.isDragging(i)},attrs:{src:t,draggable:"true","data-index":i},on:{touchstart:function(t){arguments[0]=t=e.$handleEvent(t),e.start.apply(void 0,arguments)},touchmove:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=e.$handleEvent(t),e.move.apply(void 0,arguments)},touchend:function(t){arguments[0]=t=e.$handleEvent(t),e.stop.apply(void 0,arguments)},click:function(t){arguments[0]=t=e.$handleEvent(t),e.previewImage.apply(void 0,arguments)}}}),e.isShowDel?a("v-uni-view",{staticClass:"imageDel",attrs:{"data-index":i},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.deleteImage.apply(void 0,arguments)}}},[e._v("x")]):e._e()],1)})),e.isShowAdd?a("v-uni-view",{staticClass:"imageUpload",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.selectImage.apply(void 0,arguments)}}},[e._v("+")]):e._e()],2),e.showMoveImage?a("v-uni-image",{staticClass:"moveImage",style:{left:e.posMoveImageLeft,top:e.posMoveImageTop},attrs:{src:e.moveImagePath}}):e._e()],1)},s=[]},6873:function(e,t,a){var i=a("addc");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("4f06").default;n("288a91e6",i,!0,{sourceMap:!1,shadowMode:!1})},"7e9e":function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,".imageUploadContainer[data-v-00684813]{\n/* \t\tpadding: 10upx 5upx;\n\t\tmargin: 10upx 5upx; */}.dragging[data-v-00684813]{-webkit-transform:scale(1.2);transform:scale(1.2)}.imageUploadList[data-v-00684813]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap}.imageItem[data-v-00684813], .imageUpload[data-v-00684813]{width:%?160?%;height:%?160?%\n\t\t/* margin: 10upx; */}.imageDel[data-v-00684813]{position:relative;left:%?120?%;bottom:%?165?%;background-color:rgba(0,0,0,.5);width:%?36?%;text-align:center;line-height:%?35?%;border-radius:%?17?%;color:#fff;font-size:%?30?%;padding-bottom:%?2?%}.imageItem uni-image[data-v-00684813], .moveImage[data-v-00684813]{width:%?160?%;height:%?160?%;border-radius:%?8?%}.imageUpload[data-v-00684813]{line-height:%?130?%;text-align:center;font-size:%?150?%;color:#d9d9d9;border:1px solid #d9d9d9;border-radius:%?8?%;margin:0 %?10?%}.moveImage[data-v-00684813]{position:absolute}",""]),e.exports=t},"9f5d":function(e,t,a){"use strict";var i=a("ff91"),n=a.n(i);n.a},addc:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */uni-page-body[data-v-3a1c2736]{background-color:#f5f5f5}.fb_view[data-v-3a1c2736]{width:%?750?%;height:%?396?%;background:#fff;border-bottom:1px #f5f5f5 dotted}.fb_view .fb_Text[data-v-3a1c2736]{font-weight:700;font-size:%?30?%;position:absolute;left:%?34?%;top:%?56?%}.fb_view .fb_Textarea[data-v-3a1c2736]{font-size:%?30?%;height:100px;position:absolute;left:%?33?%;top:%?125?%}.fb_view .fb_words[data-v-3a1c2736]{font-size:%?24?%;color:#aaa;position:absolute;left:%?620?%;top:%?346?%}.fb_view2[data-v-3a1c2736]{width:%?750?%;height:%?328?%;background:#fff;margin-top:%?20?%}.fb_view2 .fb_Text2[data-v-3a1c2736]{font-weight:700;font-size:%?30?%;position:absolute;left:%?34?%;top:%?476?%}.fb_view2 .scClass[data-v-3a1c2736]{position:absolute;left:%?31?%;top:%?545?%}.fb_view3[data-v-3a1c2736]{width:94%;position:fixed;bottom:%?40?%;left:3%}.fb_view3 .fb_btn[data-v-3a1c2736]{border-radius:30px;background:#ff971e;color:#fff}body.?%PAGE?%[data-v-3a1c2736]{background-color:#f5f5f5}',""]),e.exports=t},baf1:function(e,t,a){"use strict";(function(e){var i=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a("d73d")),s={components:{robbyImageUpload:n.default},data:function(){return{remnant:0,nickid:"",ideaContent:"",enableDel:!0,enableAdd:!0,enableDrag:!1,show:!0,serverUrl:"http://localhost:2000/work/uploadWorkPicture",serverUrlDeleteImage:"http://localhost:2000/work/deleteWorkPicture",formData:{userId:2},imagelist:[],detailInfo:{imageData:[]}}},onShow:function(){this.getLogin(),uni.setNavigationBarTitle({title:"意见反馈"})},methods:{getLogin:function(){uni.getStorage({key:"userInfo",fail:function(){uni.showToast({icon:"none",title:"未登录无法进行反馈,请先登录"})}})},descInput:function(e){this.remnant=e.detail.cursor},deleteImage:function(e){},addImage:function(e){},formSubmit:function(t){if(uni.showLoading({title:"提交意见反馈中..."}),0==this.remnant)uni.hideLoading(),uni.showModal({content:"请填写具体内容",showCancel:!1});else{var a=this;uni.getStorage({key:"userInfo",success:function(t){e.log(t),uni.request({url:a.$GrzxInter.Interface.AddSuggestion.value,method:a.$GrzxInter.Interface.AddSuggestion.method,data:{userId:t.data.userId,suggestion:a.ideaContent},success:function(t){e.log(t),uni.hideLoading(),"建议提交成功"==t.data.msg?(uni.showToast({title:"反馈成功"}),setTimeout((function(){uni.navigateBack()}),500)):"提交失败2分钟内请勿重复发表"==t.data.msg&&(uni.showToast({icon:"none",title:"2分钟内请勿重复发表"}),setTimeout((function(){uni.navigateBack()}),500))},fail:function(t){e.log(t),uni.hideLoading(),uni.showToast({title:"反馈失败"})}})},fail:function(){uni.showToast({icon:"none",title:"暂未登录,请登录后查看"})}})}}}};t.default=s}).call(this,a("5a52")["default"])},d3a4:function(e,t,a){"use strict";a.r(t);var i=a("baf1"),n=a.n(i);for(var s in i)"default"!==s&&function(e){a.d(t,e,(function(){return i[e]}))}(s);t["default"]=n.a},d73d:function(e,t,a){"use strict";a.r(t);var i=a("61e7"),n=a("e3b6");for(var s in n)"default"!==s&&function(e){a.d(t,e,(function(){return n[e]}))}(s);a("9f5d");var o,r=a("f0c5"),l=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,"00684813",null,!1,i["a"],o);t["default"]=l.exports},e3b6:function(e,t,a){"use strict";a.r(t);var i=a("1d25"),n=a.n(i);for(var s in i)"default"!==s&&function(e){a.d(t,e,(function(){return i[e]}))}(s);t["default"]=n.a},e47c:function(e,t,a){"use strict";var i;a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("v-uni-form",{on:{submit:function(t){arguments[0]=t=e.$handleEvent(t),e.formSubmit.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"fb_view"},[a("v-uni-text",{staticClass:"fb_Text"},[e._v("意见反馈")]),a("v-uni-textarea",{staticClass:"fb_Textarea",attrs:{"placeholder-style":"#AAAAAA",placeholder:"您的宝贵意见将会让我们提供更好的服务质量",maxlength:"500"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.descInput.apply(void 0,arguments)}},model:{value:e.ideaContent,callback:function(t){e.ideaContent=t},expression:"ideaContent"}}),a("v-uni-view",{staticClass:"fb_words"},[e._v(e._s(e.remnant)+"/500字")])],1),a("v-uni-view",{staticClass:"fb_view2"},[a("v-uni-text",{staticClass:"fb_Text2"},[e._v("上传图片")]),a("v-uni-view",{staticClass:"scClass"},[a("robby-image-upload",{attrs:{"server-url-delete-image":e.serverUrlDeleteImage,showUploadProgress:e.show,"form-data":e.formData,"enable-del":e.enableDel,"enable-add":e.enableAdd},on:{delete:function(t){arguments[0]=t=e.$handleEvent(t),e.deleteImage.apply(void 0,arguments)},add:function(t){arguments[0]=t=e.$handleEvent(t),e.addImage.apply(void 0,arguments)}},model:{value:e.detailInfo.imageData,callback:function(t){e.$set(e.detailInfo,"imageData",t)},expression:"detailInfo.imageData"}})],1)],1),a("v-uni-view",{staticClass:"fb_view3"},[a("v-uni-button",{staticClass:"fb_btn",attrs:{"form-type":"submit"}},[e._v("提交")])],1)],1)],1)},s=[]},ff91:function(e,t,a){var i=a("7e9e");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("4f06").default;n("1cb3a3c3",i,!0,{sourceMap:!1,shadowMode:!1})}}]);